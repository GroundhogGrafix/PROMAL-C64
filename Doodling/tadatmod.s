PROGRAM DATAPROCESS OWN EXPORT; LOAD AND SORT DATAINCLUDE LIBRARYINCLUDE CONSDATA WORD CAT="CATEGORIES.C"BYTE BUF[BUFSZ] ; DISK BUFFEREXPORT WORD RECPTR[25,15] ; RECORD POINTERSWORD BL ; DISK BUFF LENGTH     WORD BI ; DISK BUFF INDEXBYTE SUBSTR[81] ; GENERAL USE ARRAY FOR PROC AND FUNCBYTE RI; RECORD INDEXPROC LDCAT ; LOAD CATEGORYSWORD FHBEGINWORD READ ;FH=OPEN(CAT)IF FH=0  ABORT"CATEGORIES NOT FOUND!"GETBLKF FH, BUFEXPORT PROC LDRECS ; LOAD RECORD YEARARG WORD YR ; YEAR TO LOADWORD FH ; FILE HANDLEBEGINMOVSTR FLNM, SUBSTR, LENSTR(FLNM)MOVSTR YR, SUBSTR, 3 ; IMPLEMENT LATERFH=OPEN(SUBSTR,'R')IF FH=0  OUTPUT YR  EXIT" DOES NOT EXIST!#C"BL=GETBLKF(FH, BUF, BUFSZ)CLOSE FHIF BI=BUFSZ  ABORT"FILE EXCEEDS BUFFER SIZE"ENDEXPORT FUNC BYTE FDATE ; FIND ALL RECORDS MATCHING DATEARG WORD DATEBEGINBI=0FOR BI=0 TO BL  IF BUF[BI]=DATE@<    IF CMPSTR(BUF+BI,"=",DATE)      RECPTR[RI,0]=BUF+BI      RI=RI+1RECPTR[RI,0]=0 ; NULL END OF RECORDSIF RI>0  PARSERRETURN RIENDPROC PARSER ; PARSE RECORDSBYTE INDEXBYTE RECBYTE ROWBEGINREC=0ROW=1WHILE RECPTR[REC,0]>0  INDEX=0  WHILE (RECPTR[REC,0]+INDEX)@< <>TERMC    INDEX=INDEX+1    IF (RECPTR[REC,0]+INDEX)@<=0      RECPTR[REC,ROW]=RECPTR[REC,0]+INDEX+1      ROW=ROW+1  REC=REC+1ENDBEGIN ; MAIN PROGRAMRI=0BI=0BL=0END