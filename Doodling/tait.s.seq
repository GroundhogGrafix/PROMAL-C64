OVERLAY TAIT ; TRUCK ACCOUNTANT INPUT TRANSACTIONINCLUDE LIBRARYINCLUDE PROSYSINCLUDE CONSBYTE BUFF[500] ; PROBABLY COULD BE A LOT LESSWORD BPBYTE FN[17]DATA WORD FLSTR[]="FUEL#C#C","DATE: MM/DD/YY  ","MILEAGE: ","TRACTOR FUEL GAL: ", "TRACTOR FUEL TOTAL: ","REEFER FUEL GAL: ","REEFER FUEL TOTAL: ","DEF GALLONS: ","DEF TOTAL: ","CASH ADVANCE: ","LOCATION: ",0DATA WORD SCSTR[]="SCALE#C#C","DATE: MM/DD/YY  ","TOTAL: ","LOCATION: ",0DATA WORD PASTR[]="PARTS#C#C","DATE: MM/DD/YY  ","TOTAL: ","PARTS: ","VENDOR:","LOCATION: ",0DATA WORD RPSTR[]="REPAIR#C#C","DATE: MM/DD/YY  ","TOTAL: ","MILEAGE: ","REPAIRS: ", "SHOP: ","LOCATION: ",0DATA WORD TKSTR[]="TICKET#C#C","DATE: MM/DD/YY  ","FINE: ","CITATION NUMBER:","TYPE/REASON: ", "LOCATION: ",0DATA WORD OFSTR[]="OFFICE#C#C","DATE: MM/DD/YY  ","TOTAL: ","ITEM: ","VENDOR: ",0DATA WORD TLSTR[]="TOLL#C#C","DATE: MM/DD/YY  ","TOLL: ","LOCATION: ",0DATA WORD INSTR[]="INSURANCE#C#C","DATE: MM/DD/YY  ","TOTAL: ","TYPE: ","TRUCK NUMBER: ",0FUNC WORD RYEAR ; RETURN YEARARG WORD PTRBEGINIF LENSTR(PTR)<7  RETURN 65535RETURN PTR+6 ; RETURN PTR TO YEAR IN STRINGENDPROC ATERM ; ADD TERMINATOR CHARACTER TO SEPERATE FORMBEGINBUFF[BP]=TERMCBP=BP+1ENDPROC INCBP ; INCREMENT BUFFER POINTER BY LENGTH OF STRINGARG WORD STRBEGINBP=BP+LENSTR(STR)+1ENDFUNC BYTE SAVE2D ; SAVE DATA TO DISKWORD FH ; FILE HANDLE BEGINFH=OPEN("FINANCES",'A')IF FH=0  FH=OPEN("FINANCES",'W')  IF FH=0    RETURN 0 ; ERROR OPENING OR CREATING FILEPUTBLKF FH, BUFF, BPCLOSE FHRETURN 1 ; ALL GOODENDPROC SAVEQBYTE RV; RETRUN VALUEBEGIN OUTPUT"SAVE FORM Y/N?#C"REPEAT         CHOOSE GETKEY  'Y'    ATERM ; ADD TERMINATOR CHARACTER    OUTPUT RYEAR(BUFF)    PUT NL    RV=SAVE2D    IF RV=0      OUTPUT"#CERROR WRITING DATA!#C"    BP=0    RETURN  'N'    BP=0    RETURN  ELSE    NOTHINGUNTIL 1=0ENDFUNC BYTE ANOTHERQBEGINOUTPUT"DO ANOTHER Y/N?#C"RETURN GETKEYENDPROCOR WRITING CATEGORY!"FOR IDX= 0 TO INDEX-1   OUTPUTF FH, #STR[0,IDX]   PUTF FH, 0   OUTPUT #STR[0,IDX]  PUT NLCLOSE FHRETURNENDBEGINREPEAT  INDEX=0  PUT CS      OUTPUT"          CREATE NEW CATEGORY#C"  OUTPUT"WHEN FINISHED SIMPLY PRESS ENTER#C"    OUTPUT DATESTR             OUTPUT"ALREADY ADDED.#C"    MOVSTR DATESTR, #STR[0,INDEX]  INDEX=INDEX+1    OUTPUT"CATEGORY NAME: "  GETL #STR[0,INDEX],MAXFL  INDEX=INDEX+1    OUTPUT"THE FOLLOWING ARE KEYWORDS YOU MUST USE#C"  OUTPUT"WHEN ENTERING A RELATED FIELD.#C"    PRINTKW ; PRINT KEYWORDS    OUTPUT"ENTER EACH FIELD, PRESS ENTER WHEN DONE.#C"  REPEAT    GETL #STR[0,INDEX],MAXFL-1    INDEX=INDEX+1  UNTIL LENSTR(#STR[0,INDEX-1])=0 OR INDEX=MAXF    OUTPUT"SAVE Y/N?#C"  IF GETKEY='Y'    SAVECAT    OUTPUT"ANOTHER Y/N?#C"UNTIL GETKEY='N'END